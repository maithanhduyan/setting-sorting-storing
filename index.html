<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Asset Management</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
  <h1>Asset Management</h1>

  <table id="assetTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Code</th>
        <th>Price</th>
        <th>Website</th>
        <th>Description</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Add Asset</h2>
  <form id="addAssetForm">
    <label for="name">Name:</label>
    <input type="text" id="name" required><br>

    <label for="code">Code:</label>
    <input type="text" id="code" required><br>

    <label for="price">Price:</label>
    <input type="number" id="price" required><br>

    <label for="website">Website:</label>
    <input type="url" id="website" required><br>

    <label for="description">Description:</label>
    <textarea id="description" required></textarea><br>

    <button type="submit">Add</button>
  </form>

  <script>
    // Hàm để hiển thị danh sách tài sản
    function displayAssets(assets) {
      var tableBody = $('#assetTable tbody');
      tableBody.empty();

      $.each(assets, function (index, asset) {
        var row = '<tr>';
        row += '<td>' + asset.id + '</td>';
        row += '<td>' + asset.name + '</td>';
        row += '<td>' + asset.code + '</td>';
        row += '<td>' + asset.price + '</td>';
        row += '<td>' + asset.website + '</td>';
        row += '<td>' + asset.description + '</td>';
        row += '<td><button onclick="editAsset(' + asset.id + ')">Edit</button> <button onclick="deleteAsset(' + asset.id + ')">Delete</button></td>';
        row += '</tr>';
        tableBody.append(row);
      });
    }

    // Lấy danh sách tài sản từ RESTful API
    function getAssets() {
      $.get('http://localhost:5000/assets', function (assets) {
        displayAssets(assets);
      });
    }

    // Thêm mới tài sản
    $('#addAssetForm').submit(function (event) {
      event.preventDefault();

      var name = $('#name').val();
      var code = $('#code').val();
      var price = $('#price').val();
      var website = $('#website').val();
      var description = $('#description').val();

      var asset = {
        name: name,
        code: code,
        price: price,
        website: website,
        description: description
      };

      $.post('http://localhost:5000/assets', asset, function (response) {
        getAssets();
        $('#addAssetForm')[0].reset();
      });
    });

    // Xóa tài sản
    function deleteAsset(id) {
      $.ajax({
        url: 'http://localhost:5000/assets/' + id,
        type: 'DELETE',
        success: function (response) {
          getAssets();
        }
      });
    }

    // Chỉnh sửa tài sản
    function editAsset(id) {
      // Lấy thông tin tài sản theo id
      $.get('http://localhost:5000/assets/' + id, function (asset) {
        // Hiển thị form chỉnh sửa
        var editForm = '<h2>Edit Asset</h2>';
        editForm += '<form id="editAssetForm">';
        editForm += '<input type="hidden" id="editId" value="' + asset.id + '">';
        editForm += '<label for="editName">Name:</label>';
        editForm += '<input type="text" id="editName" value="' + asset.name + '" required><br>';
        editForm += '<label for="editCode">Code:</label>';
        editForm += '<input type="text" id="editCode" value="' + asset.code + '" required><br>';
        editForm += '<label for="editPrice">Price:</label>';
        editForm += '<input type="number" id="editPrice" value="' + asset.price + '" required><br>';
        editForm += '<label for="editWebsite">Website:</label>';
        editForm += '<input type="url" id="editWebsite" value="' + asset.website + '" required><br>';
        editForm += '<label for="editDescription">Description:</label>';
        editForm += '<textarea id="editDescription" required>' + asset.description + '</textarea><br>';
        editForm += '<button type="submit">Save</button> <button onclick="cancelEdit()">Cancel</button>';
        editForm += '</form>';

        $('#addAssetForm').html(editForm);

        // Gửi yêu cầu cập nhật tài sản
        $('#editAssetForm').submit(function (event) {
          event.preventDefault();

          var id = $('#editId').val();
          var name = $('#editName').val();
          var code = $('#editCode').val();
          var price = $('#editPrice').val();
          var website = $('#editWebsite').val();
          var description = $('#editDescription').val();

          var asset = {
            name: name,
            code: code,
            price: price,
            website: website,
            description: description
          };

          $.ajax({
            url: 'http://localhost:5000/assets/' + id,
            type: 'PUT',
            data: asset,
            success: function (response) {
              getAssets();
              $('#addAssetForm')[0].reset();
            }
          });
        });
      });
    }

    // Hủy chỉnh sửa
    function cancelEdit() {
      $('#addAssetForm')[0].reset();
    }

    // Load danh sách tài sản khi trang được tải
    getAssets();
  </script>
</body>
</html>
